<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,500,700&display=swap" rel="stylesheet" />

    <link href="./stylesheets/all.min.css" rel="stylesheet" />
    <link href="./stylesheets/bootstrap.min.css" rel="stylesheet" />
    <link href="./stylesheets/main.css" rel="stylesheet" />
    <link href="./stylesheets/carousel.css" rel="stylesheet" />

    <script src="./js/moment.min.js"></script>
    <script src="./js/jquery.min.js"></script>
    <script src="./js/bootstrap.bundle.min.js"></script>

    <title>Home Media Center</title>

    <script language="javascript">
        const keyLeft = 37;
        const keyUp = 38;
        const keyRight = 39;
        const keyDown = 40;
        const keyEnter = 13;
        const keySpace = 32;

        var seletedRow = 0;
        var selectedCol = 0;
        var table = [];

        //find all menu items
        $(document).ready(function() {
            var rows = document.querySelectorAll('.menu-row');
            for (var i = 0; i < rows.length; i++) {
                table.push(rows[i].querySelectorAll('.menu-item'));
            }
        });

        //controller connected
        window.addEventListener("gamepadconnected", function(e) {
            console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",
            e.gamepad.index, e.gamepad.id,
                e.gamepad.buttons.length, e.gamepad.axes.length);
            document.querySelector('#controllerToast .toast-body').innerHTML = "Gamepad connected: " + e.gamepad.id;
            $('#controllerToast').toast('show');
        });

        //controller disconnected
        window.addEventListener("gamepaddisconnected", function(e) {
            console.log("Gamepad disconnected from index %d: %s",
            e.gamepad.index, e.gamepad.id);
        });

        //detect keyboard input
        $(document).keydown(function (e) {
            console.log('key: ' + e.which.toString());
            //detect keypress
            if (e.which == keyUp) {
                //$("body").append("<p>ctrl+z detected!</p>");
                seletedRow--;
                //seletedRow = seletedRow < 0 ? 0 : seletedRow;
            }
            else if (e.which == keyDown) {
                seletedRow++;
                //seletedRow = seletedRow >= table.length ? table.length - 1 : seletedRow;
            }
            else if (e.which == keyLeft) {
                selectedCol--;
                if (selectedCol < 0) {
                    if (seletedRow > 0) {
                        seletedRow--;
                        selectedCol = table[seletedRow].length - 1;
                    }
                    else selectedCol = 0;
                }
            }
            else if (e.which == keyRight) {
                selectedCol++;
                if (selectedCol >= table[seletedRow].length) {
                    if (seletedRow < table.length - 1) {
                        seletedRow++;
                        selectedCol = 0;
                    }
                    else selectedCol = table[seletedRow].length - 1;
                }
            }

            //verify row
            if (seletedRow < 0) seletedRow = 0;
            else if (seletedRow >= table.length) seletedRow = table.length - 1;

            //verify colume
            if (selectedCol < 0) selectedCol = 0;
            else if (selectedCol >= table[seletedRow].length) selectedCol = table[seletedRow].length - 1;

            //clear previous selected
            var previousSelected = document.querySelector('.menu-selected');
            if (previousSelected) previousSelected.classList.remove("menu-selected");

            //set new selected
            table[seletedRow][selectedCol].classList.add("menu-selected");
        });
    </script>
</head>

<body>
	<div class="container-fluid h-100 d-flex flex-column">
		<div class="row">
            <div class="col-sm">
                <div id="controllerToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-delay="3000">
                    <!--<div class="toast-header">
                        <img src="..." class="rounded mr-2" alt="...">
                        <strong class="mr-auto">Bootstrap</strong>
                        <small class="text-muted">11 mins ago</small>
                        <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>-->
                    <div class="toast-body">
                    </div>
                </div>
            </div>
			<div class="col-sm">
				<h1 id="datetime" class="display-4 text-right text-light font-weight-lighter">
					<script lang="javascript">
						var update = function () {
							document.querySelector("#datetime").innerHTML = moment().format('HH:mm');
						}
						update();
						setInterval(update, 10000);
					</script>
				</h1>
			</div>
		</div>
        <div class="row flex-grow-1 align-items-center" style="overflow-y: auto;">
            <div class="row__inner menu-row">
                <div class="tile menu-item menu-selected">
                    <div class="tile__media">
                        <img class="tile__img" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-1.jpg"
                             alt="" />
                    </div>
                    <div class="tile__details">
                        <div class="tile__title text-light">
                            Top Gear
                        </div>
                    </div>
                </div>

                <div class="tile menu-item">
                    <div class="tile__media">
                        <img class="tile__img" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-2.jpg"
                             alt="" />
                    </div>
                    <div class="tile__details">
                        <div class="tile__title text-light">
                            Top Gear
                        </div>
                    </div>
                </div>

                <div class="tile menu-item">
                    <div class="tile__media">
                        <img class="tile__img" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-3.jpg"
                             alt="" />
                    </div>
                    <div class="tile__details text-light">
                        <div class="tile__title">
                            Top Gear
                        </div>
                    </div>
                </div>

                <div class="tile menu-item">
                    <div class="tile__media">
                        <img class="tile__img" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-4.jpg"
                             alt="" />
                    </div>
                    <div class="tile__details">
                        <div class="tile__title text-light">
                            Top Gear
                        </div>
                    </div>
                </div>

                <div class="tile menu-item">
                    <div class="tile__media">
                        <img class="tile__img" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-5.jpg"
                             alt="" />
                    </div>
                    <div class="tile__details">
                        <div class="tile__title text-light">
                            Top Gear
                        </div>
                    </div>
                </div>

                <div class="tile menu-item">
                    <div class="tile__media">
                        <img class="tile__img" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-5.jpg"
                             alt="" />
                    </div>
                    <div class="tile__details">
                        <div class="tile__title text-light">
                            Top Gear
                        </div>
                    </div>
                </div>

            </div>
            <div class="container-fluid menu-row">
                <img class="tile__img menu-item" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-1.jpg"
                     alt="" />
                <img class="tile__img menu-item" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-1.jpg"
                     alt="" />
                <img class="tile__img menu-item" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-1.jpg"
                     alt="" />
            </div>
            <div class="container-fluid menu-row">
                <img class="tile__img menu-item" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-1.jpg"
                     alt="" />
            </div>
            <div class="container-fluid menu-row">
                <img class="tile__img menu-item" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-1.jpg"
                     alt="" />
                <img class="tile__img menu-item" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/70390/show-1.jpg"
                     alt="" />
            </div>
        </div>
	</div>
</body>
</html>